#include "LGMatrix.hpp"
#include <iostream>

LGMatrix::LGMatrix(void) : PMatrix(20) {
    dirty();

    DoubleMatrix rates(20);
    rates( 0, 1) = 0.4250930; rates( 0, 2) = 0.2768180; rates( 0, 3) = 0.3951440; rates( 0, 4) = 2.4890840;
    rates( 0, 5) = 0.9698940; rates( 0, 6) = 1.0385450; rates( 0, 7) = 2.0660400; rates( 0, 8) = 0.3588580; rates( 0, 9) = 0.1498300;
    rates( 0,10) = 0.3953370; rates( 0,11) = 0.5365180; rates( 0,12) = 1.1240350; rates( 0,13) = 0.2537010; rates( 0,14) = 1.1776510;
    rates( 0,15) = 4.7271820; rates( 0,16) = 2.1395010; rates( 0,17) = 0.1807170; rates( 0,18) = 0.2189590; rates( 0,19) = 2.5478700;
    rates( 1, 0) = 0.4250930; rates( 1, 2) = 0.7518780; rates( 1, 3) = 0.1239540; rates( 1, 4) = 0.5345510;
    rates( 1, 5) = 2.8079080; rates( 1, 6) = 0.3639700; rates( 1, 7) = 0.3901920; rates( 1, 8) = 2.4266010; rates( 1, 9) = 0.1269910;
    rates( 1,10) = 0.3018480; rates( 1,11) = 6.3260670; rates( 1,12) = 0.4841330; rates( 1,13) = 0.0527220; rates( 1,14) = 0.3325330;
    rates( 1,15) = 0.8581510; rates( 1,16) = 0.5789870; rates( 1,17) = 0.5936070; rates( 1,18) = 0.3144400; rates( 1,19) = 0.1708870;
    rates( 2, 0) = 0.2768180; rates( 2, 1) = 0.7518780; rates( 2, 3) = 5.0761490; rates( 2, 4) = 0.5287680;
    rates( 2, 5) = 1.6957520; rates( 2, 6) = 0.5417120; rates( 2, 7) = 1.4376450; rates( 2, 8) = 4.5092380; rates( 2, 9) = 0.1915030;
    rates( 2,10) = 0.0684270; rates( 2,11) = 2.1450780; rates( 2,12) = 0.3710040; rates( 2,13) = 0.0895250; rates( 2,14) = 0.1617870;
    rates( 2,15) = 4.0083580; rates( 2,16) = 2.0006790; rates( 2,17) = 0.0453760; rates( 2,18) = 0.6120250; rates( 2,19) = 0.0836880;
    rates( 3, 0) = 0.3951440; rates( 3, 1) = 0.1239540; rates( 3, 2) = 5.0761490; rates( 3, 4) = 0.0625560;
    rates( 3, 5) = 0.5233860; rates( 3, 6) = 5.2438700; rates( 3, 7) = 0.8449260; rates( 3, 8) = 0.9271140; rates( 3, 9) = 0.0106900;
    rates( 3,10) = 0.0150760; rates( 3,11) = 0.2829590; rates( 3,12) = 0.0255480; rates( 3,13) = 0.0174160; rates( 3,14) = 0.3944560;
    rates( 3,15) = 1.2402750; rates( 3,16) = 0.4258600; rates( 3,17) = 0.0298900; rates( 3,18) = 0.1351070; rates( 3,19) = 0.0379670;
    rates( 4, 0) = 2.4890840; rates( 4, 1) = 0.5345510; rates( 4, 2) = 0.5287680; rates( 4, 3) = 0.0625560;
    rates( 4, 5) = 0.0848080; rates( 4, 6) = 0.0034990; rates( 4, 7) = 0.5692650; rates( 4, 8) = 0.6405430; rates( 4, 9) = 0.3206270;
    rates( 4,10) = 0.5940070; rates( 4,11) = 0.0132660; rates( 4,12) = 0.8936800; rates( 4,13) = 1.1052510; rates( 4,14) = 0.0753820;
    rates( 4,15) = 2.7844780; rates( 4,16) = 1.1434800; rates( 4,17) = 0.6701280; rates( 4,18) = 1.1655320; rates( 4,19) = 1.9592910;
    rates( 5, 0) = 0.9698940; rates( 5, 1) = 2.8079080; rates( 5, 2) = 1.6957520; rates( 5, 3) = 0.5233860; rates( 5, 4) = 0.0848080;
    rates( 5, 6) = 4.1285910; rates( 5, 7) = 0.2679590; rates( 5, 8) = 4.8135050; rates( 5, 9) = 0.0728540;
    rates( 5,10) = 0.5824570; rates( 5,11) = 3.2342940; rates( 5,12) = 1.6725690; rates( 5,13) = 0.0358550; rates( 5,14) = 0.6242940;
    rates( 5,15) = 1.2238280; rates( 5,16) = 1.0801360; rates( 5,17) = 0.2361990; rates( 5,18) = 0.2573360; rates( 5,19) = 0.2103320;
    rates( 6, 0) = 1.0385450; rates( 6, 1) = 0.3639700; rates( 6, 2) = 0.5417120; rates( 6, 3) = 5.2438700; rates( 6, 4) = 0.0034990;
    rates( 6, 5) = 4.1285910; rates( 6, 7) = 0.3488470; rates( 6, 8) = 0.4238810; rates( 6, 9) = 0.0442650;
    rates( 6,10) = 0.0696730; rates( 6,11) = 1.8071770; rates( 6,12) = 0.1737350; rates( 6,13) = 0.0188110; rates( 6,14) = 0.4194090;
    rates( 6,15) = 0.6119730; rates( 6,16) = 0.6045450; rates( 6,17) = 0.0778520; rates( 6,18) = 0.1200370; rates( 6,19) = 0.2450340;
    rates( 7, 0) = 2.0660400; rates( 7, 1) = 0.3901920; rates( 7, 2) = 1.4376450; rates( 7, 3) = 0.8449260; rates( 7, 4) = 0.5692650;
    rates( 7, 5) = 0.2679590; rates( 7, 6) = 0.3488470; rates( 7, 8) = 0.3114840; rates( 7, 9) = 0.0087050;
    rates( 7,10) = 0.0442610; rates( 7,11) = 0.2966360; rates( 7,12) = 0.1395380; rates( 7,13) = 0.0895860; rates( 7,14) = 0.1969610;
    rates( 7,15) = 1.7399900; rates( 7,16) = 0.1298360; rates( 7,17) = 0.2684910; rates( 7,18) = 0.0546790; rates( 7,19) = 0.0767010;
    rates( 8, 0) = 0.3588580; rates( 8, 1) = 2.4266010; rates( 8, 2) = 4.5092380; rates( 8, 3) = 0.9271140; rates( 8, 4) = 0.6405430;
    rates( 8, 5) = 4.8135050; rates( 8, 6) = 0.4238810; rates( 8, 7) = 0.3114840; rates( 8, 9) = 0.1088820;
    rates( 8,10) = 0.3663170; rates( 8,11) = 0.6972640; rates( 8,12) = 0.4424720; rates( 8,13) = 0.6821390; rates( 8,14) = 0.5088510;
    rates( 8,15) = 0.9900120; rates( 8,16) = 0.5842620; rates( 8,17) = 0.5970540; rates( 8,18) = 5.3068340; rates( 8,19) = 0.1190130;
    rates( 9, 0) = 0.1498300; rates( 9, 1) = 0.1269910; rates( 9, 2) = 0.1915030; rates( 9, 3) = 0.0106900; rates( 9, 4) = 0.3206270;
    rates( 9, 5) = 0.0728540; rates( 9, 6) = 0.0442650; rates( 9, 7) = 0.0087050; rates( 9, 8) = 0.1088820; 
    rates( 9,10) = 4.1450670; rates( 9,11) = 0.1590690; rates( 9,12) = 4.2736070; rates( 9,13) = 1.1127270; rates( 9,14) = 0.0782810;
    rates( 9,15) = 0.0641050; rates( 9,16) = 1.0337390; rates( 9,17) = 0.1116600; rates( 9,18) = 0.2325230; rates( 9,19) = 10.649107;
    rates(10, 0) = 0.3953370; rates(10, 1) = 0.3018480; rates(10, 2) = 0.0684270; rates(10, 3) = 0.0150760; rates(10, 4) = 0.5940070;
    rates(10, 5) = 0.5824570; rates(10, 6) = 0.0696730; rates(10, 7) = 0.0442610; rates(10, 8) = 0.3663170; rates(10, 9) = 4.1450670;
    rates(10,11) = 0.1375000; rates(10,12) = 6.3123580; rates(10,13) = 2.5926920; rates(10,14) = 0.2490600;
    rates(10,15) = 0.1822870; rates(10,16) = 0.3029360; rates(10,17) = 0.6196320; rates(10,18) = 0.2996480; rates(10,19) = 1.7027450;
    rates(11, 0) = 0.5365180; rates(11, 1) = 6.3260670; rates(11, 2) = 2.1450780; rates(11, 3) = 0.2829590; rates(11, 4) = 0.0132660;
    rates(11, 5) = 3.2342940; rates(11, 6) = 1.8071770; rates(11, 7) = 0.2966360; rates(11, 8) = 0.6972640; rates(11, 9) = 0.1590690;
    rates(11,10) = 0.1375000; rates(11,12) = 0.6566040; rates(11,13) = 0.0239180; rates(11,14) = 0.3903220;
    rates(11,15) = 0.7486830; rates(11,16) = 1.1368630; rates(11,17) = 0.0499060; rates(11,18) = 0.1319320; rates(11,19) = 0.1852020;
    rates(12, 0) = 1.1240350; rates(12, 1) = 0.4841330; rates(12, 2) = 0.3710040; rates(12, 3) = 0.0255480; rates(12, 4) = 0.8936800;
    rates(12, 5) = 1.6725690; rates(12, 6) = 0.1737350; rates(12, 7) = 0.1395380; rates(12, 8) = 0.4424720; rates(12, 9) = 4.2736070;
    rates(12,10) = 6.3123580; rates(12,11) = 0.6566040; rates(12,13) = 1.7988530; rates(12,14) = 0.0998490;
    rates(12,15) = 0.3469600; rates(12,16) = 2.0203660; rates(12,17) = 0.6961750; rates(12,18) = 0.4813060; rates(12,19) = 1.8987180;
    rates(13, 0) = 0.2537010; rates(13, 1) = 0.0527220; rates(13, 2) = 0.0895250; rates(13, 3) = 0.0174160; rates(13, 4) = 1.1052510;
    rates(13, 5) = 0.0358550; rates(13, 6) = 0.0188110; rates(13, 7) = 0.0895860; rates(13, 8) = 0.6821390; rates(13, 9) = 1.1127270;
    rates(13,10) = 2.5926920; rates(13,11) = 0.0239180; rates(13,12) = 1.7988530; rates(13,14) = 0.0944640;
    rates(13,15) = 0.3618190; rates(13,16) = 0.1650010; rates(13,17) = 2.4571210; rates(13,18) = 7.8039020; rates(13,19) = 0.6546830;
    rates(14, 0) = 1.1776510; rates(14, 1) = 0.3325330; rates(14, 2) = 0.1617870; rates(14, 3) = 0.3944560; rates(14, 4) = 0.0753820;
    rates(14, 5) = 0.6242940; rates(14, 6) = 0.4194090; rates(14, 7) = 0.1969610; rates(14, 8) = 0.5088510; rates(14, 9) = 0.0782810;
    rates(14,10) = 0.2490600; rates(14,11) = 0.3903220; rates(14,12) = 0.0998490; rates(14,13) = 0.0944640; 
    rates(14,15) = 1.3381320; rates(14,16) = 0.5714680; rates(14,17) = 0.0951310; rates(14,18) = 0.0896130; rates(14,19) = 0.2965010;
    rates(15, 0) = 4.7271820; rates(15, 1) = 0.8581510; rates(15, 2) = 4.0083580; rates(15, 3) = 1.2402750; rates(15, 4) = 2.7844780;
    rates(15, 5) = 1.2238280; rates(15, 6) = 0.6119730; rates(15, 7) = 1.7399900; rates(15, 8) = 0.9900120; rates(15, 9) = 0.0641050;
    rates(15,10) = 0.1822870; rates(15,11) = 0.7486830; rates(15,12) = 0.3469600; rates(15,13) = 0.3618190; rates(15,14) = 1.3381320;
    rates(15,16) = 6.4722790; rates(15,17) = 0.2488620; rates(15,18) = 0.4005470; rates(15,19) = 0.0983690;
    rates(16, 0) = 2.1395010; rates(16, 1) = 0.5789870; rates(16, 2) = 2.0006790; rates(16, 3) = 0.4258600; rates(16, 4) = 1.1434800;
    rates(16, 5) = 1.0801360; rates(16, 6) = 0.6045450; rates(16, 7) = 0.1298360; rates(16, 8) = 0.5842620; rates(16, 9) = 1.0337390;
    rates(16,10) = 0.3029360; rates(16,11) = 1.1368630; rates(16,12) = 2.0203660; rates(16,13) = 0.1650010; rates(16,14) = 0.5714680;
    rates(16,15) = 6.4722790; rates(16,17) = 0.1408250; rates(16,18) = 0.2458410; rates(16,19) = 2.1881580;
    rates(17, 0) = 0.1807170; rates(17, 1) = 0.5936070; rates(17, 2) = 0.0453760; rates(17, 3) = 0.0298900; rates(17, 4) = 0.6701280;
    rates(17, 5) = 0.2361990; rates(17, 6) = 0.0778520; rates(17, 7) = 0.2684910; rates(17, 8) = 0.5970540; rates(17, 9) = 0.1116600;
    rates(17,10) = 0.6196320; rates(17,11) = 0.0499060; rates(17,12) = 0.6961750; rates(17,13) = 2.4571210; rates(17,14) = 0.0951310;
    rates(17,15) = 0.2488620; rates(17,16) = 0.1408250; rates(17,18) = 3.1518150; rates(17,19) = 0.1895100;
    rates(18, 0) = 0.2189590; rates(18, 1) = 0.3144400; rates(18, 2) = 0.6120250; rates(18, 3) = 0.1351070; rates(18, 4) = 1.1655320;
    rates(18, 5) = 0.2573360; rates(18, 6) = 0.1200370; rates(18, 7) = 0.0546790; rates(18, 8) = 5.3068340; rates(18, 9) = 0.2325230;
    rates(18,10) = 0.2996480; rates(18,11) = 0.1319320; rates(18,12) = 0.4813060; rates(18,13) = 7.8039020; rates(18,14) = 0.0896130;
    rates(18,15) = 0.4005470; rates(18,16) = 0.2458410; rates(18,17) = 3.1518150; rates(18,19) = 0.2493130;
    rates(19, 0) = 2.5478700; rates(19, 1) = 0.1708870; rates(19, 2) = 0.0836880; rates(19, 3) = 0.0379670; rates(19, 4) = 1.9592910;
    rates(19, 5) = 0.2103320; rates(19, 6) = 0.2450340; rates(19, 7) = 0.0767010; rates(19, 8) = 0.1190130; rates(19, 9) = 10.649107;
    rates(19,10) = 1.7027450; rates(19,11) = 0.1852020; rates(19,12) = 1.8987180; rates(19,13) = 0.6546830; rates(19,14) = 0.2965010;
    rates(19,15) = 0.0983690; rates(19,16) = 2.1881580; rates(19,17) = 0.1895100; rates(19,18) = 0.2493130;

    for(int i = 0; i < 20; i++){
        double total = 0.0;
        for(int j = 0; j < 20; j++){
            total += rates(i, j);
        }
        rates(i, i) = total * -1;
    }

    std::cout << rates << std::endl;

    //Do eigen value calculations to set the PMatrix values
}

void LGMatrix::accept() {}

void LGMatrix::reject() {}

void LGMatrix::regenerate() {}

DoubleMatrix LGMatrix::P(double v) {
    DoubleMatrix p(20);

    for(int i = 0; i < 4; i++){
        for(int j = 0; j < 4; j++){
            p(i, j) = 0.0; //Matrix exp using v and PMatrix here
        }
    }

    return p;
}